---
import { Icon } from '@design-system/elements/Icon';
import { HTMLAttributes } from 'astro/types';
import { Modal } from '.';
import { getLocaleFromURL } from 'src/utilities/locale/translation';
import { SiteSettingsProps, useSiteSettings } from 'src/utilities/api/queries';

interface Props extends HTMLAttributes<'button'> {
	id: string;
	title: string;
	label: string;
}

const { class: className, id, title, label, ...attrs } = Astro.props;
const locale = getLocaleFromURL(Astro.url.pathname);
const siteSettings: SiteSettingsProps = await useSiteSettings({ locale });
---

<>
	<button
		type="button"
		id={`info-modal-${id}`}
		class={`c-info-modal${className ? ` | ${className}` : ''}`}
		{...attrs}
	>
		<span class="u-visually-hidden">
			{label}
		</span>
		<Icon
			class="c-info-modal__icon"
			name="info"
			description={siteSettings.accessibility.labelModal}
		/>
	</button>

	<Modal id={`info-modal-${id}`} title={title}>
		<slot />
	</Modal>
</>

<style lang="scss">
	@use '@design-system-styles/tools/_a11y.scss';

	.c-info-modal {
		display: block;
		color: var(--color-donkerblauw);
		padding: var(--space-2);
		cursor: pointer;

		&:hover {
			color: var(--color-accent-robijnrood);
		}

		&:focus-visible {
			@include a11y.focusring;
		}
	}

	.c-info-modal__icon {
		--icon-size: 0.8888888889em;
		display: block;
	}
</style>

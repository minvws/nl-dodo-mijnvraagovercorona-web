---
import { Sprite } from 'astro-icon';
import MetaData from 'src/components/MetaData.astro';
import {
	MetaDataProps,
	SiteSettingsProps,
	useSiteSettings,
} from 'src/utilities/api/queries';
import { availableLocales, Locale } from 'src/utilities/locale/translation';

import '@design-system/globals.scss';
import { Masthead, SkipLink } from '@design-system/components/Masthead';
import { LocaleSelector } from '@design-system/components/LocaleSelector';

export interface Props {
	locale: Locale;
	metaData: MetaDataProps;
	skipPageSuffix?: boolean;
}

const { locale, metaData, skipPageSuffix } = Astro.props;
const siteSettings: SiteSettingsProps = await useSiteSettings({ locale });
---

<!DOCTYPE html>
<html lang={locale.id}>
	<head>
		<MetaData {...metaData} locale={locale} skipPageSuffix={skipPageSuffix} />
		<style lang="scss" is:global>
			:where(body) {
				display: flex;
				flex-direction: column;
			}
			:where(main) {
				flex: 1;
			}
		</style>
	</head>
	<body>
		<Sprite.Provider>
			<Masthead
				logoUrl={locale.urlPrefix}
				logoAlt={siteSettings.header.logoAlt}
			>
				<SkipLink label={siteSettings.header.skipLink} slot="start" />
				<LocaleSelector
					locales={availableLocales}
					currentLocale={locale}
					slot="end"
					labelChange={siteSettings.header.localeSelector.change}
					labelCurrent={siteSettings.header.localeSelector.current}
				/>
			</Masthead>
			<main id="content">
				<slot />
			</main>
			<mark>mastfoot</mark>
		</Sprite.Provider>
	</body>
</html>

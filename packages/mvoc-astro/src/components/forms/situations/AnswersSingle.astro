---
import { ContentBlock, ContentBlockProps } from '@modules/ContentBlock';
import { getLocaleFromURL } from 'src/utilities/locale/translation';
import type { Props as SubmitProps } from './Submit.astro';
import { moduleName as AnswersSingleModuleName } from './AnswersSingle';
import Submit from './Submit.astro';
import { Control } from '@design-system/elements/Control';
import Stack from '@design-system/components/layout/Stack.astro';

export interface Props {
	answers: {
		content: ContentBlockProps['value'];
		next: string;
		_key: string;
	}[];
	buttons: SubmitProps['buttons'];
	// content: ContentStreamProps;
}

const { answers, buttons } = Astro.props;
const locale = getLocaleFromURL(Astro.url.pathname);

const parsedButtons = buttons?.map((button, index) =>
	index === 0 && button.standard
		? {
				...button,
				disabled: true,
		  }
		: {
				...button,
		  },
);
---

<form method="post" data-module={AnswersSingleModuleName}>
	<Stack gap="small">
		{
			answers.map(({ content, next, _key }) => (
				<Control
					type="radio"
					name={AnswersSingleModuleName}
					id={_key}
					value={`${locale.urlPrefix}/${next}` || ''}
					variant="tile"
				>
					<ContentBlock value={content} />
				</Control>
			))
		}
	</Stack>
	<Submit buttons={parsedButtons} />
</form>

<script>
	import { initAnswersSingle } from './AnswersSingle';
	initAnswersSingle();
</script>

---
import { Heading } from '@design-system/elements/Heading';
import { Tale } from 'src/utilities/api/queries';
import { MultiContentBlock } from '../ContentBlock';
import { Switcher } from '../Layout/Grid';
import { Retain } from '../Layout/Retain';
import { Stack } from '../Layout/Stack';
import { Picture } from '../Picture';
import { stringToSlug } from 'src/utilities/stringToSlug';

// type Props = Tale;

interface Props extends Tale {
	anchorable?: boolean;
	renderTitle?: boolean;
}

const {
	title,
	multiContentBlocks,
	picture,
	renderTitle = true,
	anchorable = true,
} = Astro.props;
---

<section class="c-tale" id={anchorable ? stringToSlug(title) : undefined}>
	<Switcher class="c-tale__switcher">
		<Retain variant={'text'}>
			<Stack>
				{renderTitle ? <Heading>{title}</Heading> : undefined}
				{
					multiContentBlocks ? (
						<MultiContentBlock multiContentBlocks={multiContentBlocks} />
					) : null
				}
			</Stack>
		</Retain>
		{picture ? <Picture class="c-tale__picture" {...picture} /> : null}
	</Switcher>
</section>

<style lang="scss">
	@use '@design-system-styles/tools/_rem.scss';
	@use '@design-system-styles/tools/_list.scss';

	.c-tale {
		&:nth-of-type(even) {
			.c-tale__switcher {
				flex-direction: row-reverse;
			}
		}
	}

	.c-tale__picture {
		:global(img) {
			inline-size: 100%;
			max-inline-size: #{rem.convert(280px)};
			margin-inline: auto;
		}
	}
</style>
